<!DOCTYPE html>
<html lang="en">

	<head>
        <!--
        * Working with dynamic table
        * WebSite: http://www.dynatable.com/
        -->

        <!--    Bootstrap v2.3.2 -->
        <link rel="stylesheet" media="all" href="https://s3.amazonaws.com/dynatable-docs-assets/css/bootstrap-2.3.2.min.css" />
        <!-- Plugin styles -->
        <link rel="stylesheet" media="all" href="https://s3.amazonaws.com/dynatable-docs-assets/css/jquery.dynatable.css" />

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.4.3/css/flag-icon.css">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" />

        <!--  jQuery v3.0.0-beta1 -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.js"></script>

        <script src='https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js'></script>


        <!-- JS Pluging -->
        <script type='text/javascript' src='https://s3.amazonaws.com/dynatable-docs-assets/js/jquery.dynatable.js'></script>

        <style>


            .table-wrapper{
                width: 60%;
            }


            #map6 {
                position: absolute;
                left: 90px;
                width: 920px;
                height: 600px;
            }



        </style>

    </head>

    <body>

        <div class="table-wrapper">
            </div>
            <div class = "container">
                <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
            		<thead>
            	      <th>Country</th>
            	      <th>Institution</th>
            		  <th>Name</th>
                      <th>Website</th>
            		  <th>Location</th>
            	    </thead>
            	    <tbody>
            	    </tbody>
                </table>
            </div>
        <div>

        <div id="map6"></div>

        <script>




                var data = {
               "type":"FeatureCollection",
               "features":[
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Argentinien",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de la Republica de Argentina",
                        "address":"Jungfraustrasse 1, 3005 Berne ",
                        "website":"http:\/\/www.esuiz.mrecic.gob.ar",
                        "code":"ar"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.454704,
                           46.943993
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Bolivia",
                        "institution":"Konsulat",
                        "name":"Consulado général de la Republica de Bolivia",
                        "address":"Rue de Lausanne 72, 1202 Genève ",
                        "website":"http:\/\/www.Konsulatboliviasuiza.com",
                        "code":"bo"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.147492,
                           46.215722
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Chile",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Chile",
                        "address":"Eigerplatz 5, 3007 Berne ",
                        "website":"http:\/\/chileabroad.gov.cl\/berna",
                        "code":"cl"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.431628,
                           46.940963
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Chile",
                        "institution":"Konsulat",
                        "name":"Consulado de la Republica de Chile",
                        "address":"Fuhrstrasse 12, Unterer Leihof, 8820 Wädenswil",
                        "website":null,
                        "code":"cl"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.669301,
                           47.225837
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Colombia",
                        "institution":"Konsulat",
                        "name":"Sección consular de la Embajada de Colombia",
                        "address":"Zieglerstrasse 29, 3007 Berne ",
                        "website":"http:\/\/berna.Konsulat.gov.co",
                        "code":"co"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.42996,
                           46.945014
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Costa Rica",
                        "institution":"Konsulat",
                        "name":"Consulado de la Republica de Costa rica",
                        "address":"Chemin de Mornex 38, 1001 Lausanne ",
                        "website":null,
                        "code":"cr"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.625571,
                           46.519552
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Costa Rica",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Costa Rica",
                        "address":"Marktgasse 51, 3011 Berne ",
                        "website":null,
                        "code":"cr"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.444767,
                           46.947961
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Cuba",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Cuba",
                        "address":"Gesellschaftsstrasse 8, 3012 Berne ",
                        "website":"http:\/\/misiones.minrex.gob.cu\/es\/suiza\/servicios-consulares",
                        "code":"cu"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.437501,
                           46.952284
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Ecuador",
                        "institution":"Konsulat",
                        "name":"Consulado de la Republica de Ecuador ",
                        "address":"chemin Rieu 18, Aesthetics-Clinic Geneva, 1208 Genève ",
                        "website":null,
                        "code":"ec"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.165106,
                           46.19433
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Ecuador",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Ecuador",
                        "address":"Kramgasse 54, 3011 Berne ",
                        "website":"www.embajadadelecuador.ch",
                        "code":"ec"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.449746,
                           46.948111
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Ecuador",
                        "institution":"Konsulat",
                        "name":"Consulado de la Republica de Ecuador ",
                        "address":"Schiffbaustrasse 2, c\/o Meyerlustenberger Lachenal AG, 8005 Zurich ",
                        "website":null,
                        "code":"ec"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.519883,
                           47.388269
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"El Salvador",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de El Salvador",
                        "address":"Rue de Lausanne 65, 1202 Genève ",
                        "website":"http:\/\/embajadasuiza.rree.gob.sv\/",
                        "code":"sv"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.146822,
                           46.215552
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"España",
                        "institution":"Konsulat",
                        "name":"Consulado general de España",
                        "address":"Avenue Blanc 53, 2ème étage, 1202 Genève",
                        "website":"http:\/\/www.exteriores.gob.es\/Konsulats\/ginebra",
                        "code":"es"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.148155,
                           46.22164
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"España",
                        "institution":"Botschaft",
                        "name":"Botschaftsrat für Bildung ",
                        "address":"Kirchenfeldstrasse 42, 3005 Berne",
                        "website":"http:\/\/www.mecd.gob.es\/suiza",
                        "code":"es"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.452579,
                           46.94009
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"España",
                        "institution":"Botschaft",
                        "name":"Conseiller travail et affaires sociales ",
                        "address":"Kirchenfeldstrasse 42, 3005 Berne ",
                        "website":"http:\/\/www.empleo.gob.es\/suiza",
                        "code":"es"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.452579,
                           46.94009
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"España",
                        "institution":"Botschaft",
                        "name":"Botschaftsrat für Wirtschaft ",
                        "address":"Länggassstrasse 31, 3012 Berne ",
                        "website":"http:\/\/suiza.oficinascomerciales.es",
                        "code":"es"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.432221,
                           46.953162
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"España",
                        "institution":"Konsulat",
                        "name":"Consulado général d'Espagne ",
                        "address":"Marienstrasse 12, 3005 Berne ",
                        "website":"http:\/\/www.exteriores.gob.es\/Konsulats\/berna",
                        "code":"es"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.463152,
                           46.938208
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"España",
                        "institution":"Konsulat",
                        "name":"Consulado général de España",
                        "address":"Riedtlistrasse 17, 8006 Zurich",
                        "website":"http:\/\/www.exteriores.gob.es\/Konsulats\/zurich",
                        "code":"es"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.547669,
                           47.386689
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Guatemala",
                        "institution":"Konsulat",
                        "name":"Consulado de Guatemala ",
                        "address":"Fuhrstrasse 12, Unterer Leihof, 8820 Wädenswil ",
                        "website":null,
                        "code":"gt"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.669301,
                           47.225837
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Guatemala",
                        "institution":"Botschaft",
                        "name":"Embajada de Guatemala",
                        "address":"Jubiläumstrasse 41, 3005 Berne ",
                        "website":null,
                        "code":"gt"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.450387,
                           46.938048
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Honduras",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Honduras",
                        "address":"Avenue de France 23, 1202 Genève ",
                        "website":null,
                        "code":"hn"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.143777,
                           46.220016
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"México",
                        "institution":"Konsulat",
                        "name":"Consulado de México ",
                        "address":"Neusatzweg 32, 4102 Binningen ",
                        "website":null,
                        "code":"mx"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           47.539759,
                           47.539759
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"México",
                        "institution":"Konsulat",
                        "name":"Consulado de México ",
                        "address":"Rue de Candolle 16, 1205 Genève ",
                        "website":null,
                        "code":"mx"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.144726,
                           46.19813
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"México",
                        "institution":"Konsulat",
                        "name":"Consulado de México ",
                        "address":"Tödistrasse 16, 1er étage, 8002 Zurich ",
                        "website":null,
                        "code":"mx"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.535737,
                           47.365051
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"México",
                        "institution":"Konsulat",
                        "name":"Consulado de México ",
                        "address":"Via Nassa\/Via Dogana Vecchia 2, 6900 Lugano ",
                        "website":null,
                        "code":"mx"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.950181,
                           46.002926
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"México",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Mexico",
                        "address":"Weltpoststrasse 20, 3015 Berne ",
                        "website":"http:\/\/embamex.sre.gob.mx\/suiza\/",
                        "code":"mx"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.476429,
                           46.93754
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Nicaragua",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Nicaragua",
                        "address":"Rue de Vermont 37\/39, 1202 Genève ",
                        "website":null,
                        "code":"ni"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.137203,
                           46.218862
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Pánama",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Panama",
                        "address":"rue de Lausanne 72, 1202 Genève ",
                        "website":null,
                        "code":"pa"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.147492,
                           46.215722
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Paraguay",
                        "institution":"Konsulat",
                        "name":"Sección consular de la Embajada de Paraguay",
                        "address":"Kramgasse 58, 3000 Berne 8 ",
                        "website":null,
                        "code":"py"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.449462,
                           46.948079
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Paraguay",
                        "institution":"Konsulat",
                        "name":"Consulado de la Republica de Paraguay",
                        "address":"Via Domenico Fontana 14, 6900 Lugano ",
                        "website":null,
                        "code":"py"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.943337,
                           45.992877
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Peru",
                        "institution":"Konsulat",
                        "name":"Consulado général du Pérou ",
                        "address":"Löwenstrasse 69, 8001 Zurich",
                        "website":"http:\/\/www.conperzurich.ch",
                        "code":"pe"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.538258,
                           47.377244
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Peru",
                        "institution":"Konsulat",
                        "name":"Consulado general del Peru",
                        "address":"Rue des Pierres-du-Niton 17, 1207 Genève ",
                        "website":"http:\/\/www.conperginebra.ch",
                        "code":"pe"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           6.157145,
                           46.203837
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Peru",
                        "institution":"Konsulat",
                        "name":"Sección consular de la Embajada del Peru",
                        "address":"Thunstrasse 36, 3005 Berne ",
                        "website":"http:\/\/www.embaperu.ch",
                        "code":"pe"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.455821,
                           46.941251
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Republica Dominicana",
                        "institution":"Konsulat",
                        "name":"Consulado général de la République dominicaine ",
                        "address":"Löwenstrasse 65, 8001 Zurich ",
                        "website":null,
                        "code":"do"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           8.53809,
                           47.377083
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Republica Dominicana",
                        "institution":"Konsulat",
                        "name":"Sección consular de la Embajada de la Republica Dominicana",
                        "address":"Weltpoststrasse 4, 3000 Berne",
                        "website":null,
                        "code":"do"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.473462,
                           46.938916
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Uruguay",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Uruguay",
                        "address":"Kramgasse 63, 3011 Berne ",
                        "website":null,
                        "code":"uy"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.449251,
                           46.9478
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Uruguay",
                        "institution":"Konsulat",
                        "name":"Consulado de Uruguay ",
                        "address":"Steinenring 15, 4051 Bâle ",
                        "website":null,
                        "code":"uy"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.578684,
                           47.552293
                        ]
                     }
                  },
                  {
                     "type":"Feature",
                     "properties":{
                        "country":"Venezuela",
                        "institution":"Botschaft",
                        "name":"Sección consular de la Embajada de Venezuela",
                        "address":"Waldeggstrasse 47, 3097 Liebefeld ",
                        "website":"http:\/\/suiza.embajada.gob.ve\/",
                        "code":"ve"
                     },
                     "geometry":{
                        "type":"Point",
                        "coordinates":[
                           7.419439,
                           46.932428
                        ]
                     }
                  }
               ]
            }



            var records = [],
                i,
                id,
                marker;



            // console.log(data)

            for (i = 0; i < data.features.length; i++) {

                record = data.features[i].properties;
                // console.log(record);
				record.countryName = record.country;
                record.country = '<span class="flag-icon flag-icon-' +
                    record.code + '"></span><span> ' + record.country +
                    '</span>';

                // creating hyperlink if a website exists
                if (record.website) {
                    record.website = '<a href="' + record.website +
                        '" target="_blank">Link</a>';
                } else {
                    record.website = '';
                };


                // creating unique id
                id = record.code + '_' + record.institution;
				// var markerURL = 'https://image.flaticon.com/icons/svg/149/149060.svg'
				// var markerImage = '<img src="' + markerURL + '">'

                // creating link to map
                record.location = '<div id="' + id +
                    '" class="popup" onclick="zoomToMarker(this.id)">Map' +
                    '<span class="popuptext" id="_' + id +
                    '"><div id="' + 'map_' + id +
                    '" class="tableMap"></div></span></div>';

				console.log(L.Icon.Default.imagePath);

                data.features[i].properties.id = id;

                records.push(record);
            };

            // console.log(records)


            $('#example').dynatable({
              dataset: {
                records: records
              }
            });



            // setting up new map

			// setting up base layer of map
			var tileLayer = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
				name: 'tileLayer',
				maxZoom: 19,
				attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'
			});

			// setting default map view
			var defaultMapCenter = [46.80, 8.35];
			var defaultMapZoom = 8;

			// initializing map
			var map6 = L.map('map6', {
				layers: tileLayer,
				center: defaultMapCenter,
				zoom: defaultMapZoom,
				// zoomControl: false,
				touchZoom: true,
				// setting zoom restrictions
				maxZoom: 18,
				minZoom: defaultMapZoom
			});

			// setting panning restrictions
			var bounds = map6.getBounds();
			// map.setMaxBounds(bounds);
			// map.on('drag', function() {
			  // map.panInsideBounds(bounds, { animate: false });
			// });

			// adding tyle layer to our map
			tileLayer.addTo(map6);

			// adding legend to map
			L.control.scale({imperial: false}).addTo(map6);

			/*
			var greenIcon = L.icon({
			    iconUrl: 'https://image.flaticon.com/icons/svg/660/660623.svg',

			    iconSize:     [38, 95], // size of the icon
			    shadowSize:   [50, 64], // size of the shadow
			    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
			    shadowAnchor: [4, 62],  // the same for the shadow
			    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
			});
			*/


            // Add requested external GeoJSON to map
    		var embassyMarkers = L.geoJson(data, {
                pointToLayer: function(feature, latlng) {
                    var location = L.latLng(feature.x, feature.x);

					// var marker = L.marker(latlng, {icon: greenIcon});
                    var marker =  L.marker(latlng);

					var popup = ''.concat(
						'<b>', feature.properties.name, '</b>',
						'<br>', feature.properties.institution + ' ' + feature.properties.countryName,
						'<br>', feature.properties.address
					);

                    // var popup = feature.properties.address;

                    marker.bindPopup(popup);

                    return marker;
                }
    		})
            embassyMarkers.addTo(map6);


            function zoomToMarker(id) {


                embassyMarkers.eachLayer(function(marker) {


                    if (marker.feature.properties.id == id) {
                        console.log(marker);
                        marker.openPopup();
						var latlng = L.latLng(47.377244, 8.538258);
						// map6.flyTo(defaultMapCenter, defaultMapZoom, { duration: 0, });
						map6.setView(defaultMapCenter, defaultMapZoom);

						setTimeout(function (){
							map6.flyTo(marker.getLatLng(), 14, { duration: 4, });

						}, 800); // How long do you want the delay to be (in milliseconds)?

                        // map6.panTo(latlng);
                    }


                });
                // console.log(embassyMarker);

                // map6.panTo(embassyMarker);


            }


        </script>

    </body>


</html>
